(function($){$.fn.quoteShare=function(options){return this.each(function(){console.log('aab');var unique=$(this).context.offsetTop+'-'+$(this).context.offsetLeft;var id='qs-popup-'+unique;var settings=$.extend({animation:75,background:'#262626',boxShadow:true,minLength:1,maxLength:500,twitterColor:'#ffffff',twitterElipses:true,twitterHashtags:'',twitterVia:'',},options);$('body').append('<div id="'+id+'">');$('#'+id).css({'background':settings.background,'font-size':'24px','height':'40px','width':'40px','border-radius':'4px','padding':'9px','padding-top':'10px','box-sizing':'border-box'});if(settings.boxShadow){$('#'+id).css({'box-shadow':'0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)'});}
$('#'+id).append('<a class="qs-sharelink qs-twitter qs-twitter-'+unique+'"><i class="fa fa-twitter share-icon" aria-hidden="true"></i></a>');$('.qs-sharelink').css({'z-index':1,'cursor':'pointer','position':'absolute'})
$("a.qs-twitter-"+unique).css({'color':settings.twitterColor,});$('.share-icon').css({'margin-top':'-3px','position':'absolute'});$('#'+id).append('<div class="qs-popup-arrow-'+unique+'">&nbsp;</div>');$('.qs-popup-arrow-'+unique).css({'background':settings.background,'width':'20px','height':'20px','margin':'0 auto','margin-top':'12px','transform':'rotate(45deg)'});var hidePopup={'position':'absolute','top':'-10000px','left':'-10000px'};$('#'+id).css(hidePopup).slideUp().addClass('qs-popup-hidden').removeClass('qs-popup-shown');var text="";$(this).mouseup(function(e){var selection=window.getSelection();var text=selection.toString();var len=text.length;var range=selection.getRangeAt(0).cloneRange();var rect=range.getClientRects()[0];var left=rect.left;var top=rect.top;var right=rect.right;var mid=(left+right)/2
var scroll=$(window).scrollTop();var newText=text.replace(/(\r\n|\n|\r)/gm,"").trim();var text=newText;var showPopup={'top':top+scroll-50,'left':mid-20};if(len>settings.minLength&&len<settings.maxLength){$('#'+id).css(showPopup).slideDown(settings.animation).addClass('qs-popup-shown').removeClass('qs-popup-hidden');if(settings.twitterElipses==true){var textTotal=text.length+2;var viaLength=settings.twitterVia.length;var hashtagsLength;var hashtagsArray=(settings.twitterHashtags).split(',');var hashtagsLengthArray=[];for(var i=0;i<hashtagsArray.length;i++){var currHash=' #'+hashtagsArray[i].trim();var currHashLength=currHash.length;hashtagsLengthArray.push(currHashLength);}
var hashtagsTotal=0;$.each(hashtagsLengthArray,function(){hashtagsTotal+=this;});if(hashtagsTotal<3){hashtagsTotal=0;}
var viaTotal=0;if(viaLength>0){viaTotal=viaLength+6;}
var tweetLength=textTotal+viaTotal+hashtagsTotal+24;var excess=tweetLength-140;if(excess>0){var abridge=text.substr(0,text.length-(excess+3));text=abridge+'...';}}
var urlStart='http://twitter.com/share?text="'+text+'"';var urlVia='';var urlHashtags='';var urlRelated='';if(settings.twitterVia!=''){urlVia='&amp;via='+settings.twitterVia;}
if(settings.twitterHashtags!=''){urlHashtags='&amp;hashtags='+settings.twitterHashtags;}
var shareTwitter=urlStart.concat(urlVia,urlHashtags);$('a.qs-twitter').attr('onclick',"popUp=window.open('"+shareTwitter+"','popupwindow','scrollbars=yes,width=600,height=250');popUp.focus();return false");}else{$('#'+id).css(hidePopup).slideUp().addClass('qs-popup-hidden').removeClass('qs-popup-shown');}});$('body').mousedown(function(){if($('#'+id).hasClass('qs-popup-shown')){setTimeout(function(){$('#'+id).css(hidePopup).slideUp().removeClass('qs-popup-shown').addClass('qs-popup-hidden');},200);}});});};}(jQuery));